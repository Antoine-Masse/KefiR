% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sys_manova_analysis.R
\name{.manova_analysis}
\alias{.manova_analysis}
\title{Multivariate Analysis of Variance (MANOVA)}
\usage{
.manova_analysis(
  x = NULL,
  g = NULL,
  formula = NULL,
  data = NULL,
  paired = FALSE,
  id = NULL,
  within = NULL,
  between = NULL,
  alpha = 0.05,
  k = NULL,
  code = FALSE,
  debug = FALSE,
  verbose = FALSE,
  boot = TRUE,
  silent = TRUE,
  return = TRUE
)
}
\arguments{
\item{x}{Numeric matrix or data frame. Multiple dependent variables to be analyzed.
Can also be NULL if using formula interface.}

\item{g}{Factor or data frame. Grouping variable(s) for the analysis.}

\item{formula}{Optional formula specifying the model (e.g., cbind(Y1, Y2, Y3) ~ A * B).}

\item{data}{Optional data frame containing variables specified in the formula.}

\item{paired}{Logical. Indicates whether data are from repeated measures (default: FALSE).}

\item{id}{Optional. Identifier for paired/repeated measures data.}

\item{within}{Character vector. Within-subject factors (repeated measures).}

\item{between}{Character vector. Between-subject factors.}

\item{alpha}{Numeric. Significance level for hypothesis testing (default: 0.05).}

\item{k}{Optional counter for verbose messages (auto-initialized to 0 if NULL).}

\item{code}{Logical. If TRUE, displays R code snippets (default: FALSE).}

\item{debug}{Logical. If TRUE, displays detailed debugging messages (default: FALSE).}

\item{verbose}{Logical. If TRUE, provides detailed output during analysis (default: FALSE).}

\item{boot}{Logical. If TRUE, uses bootstrap for post-hoc tests (default: TRUE).}

\item{silent}{Logical. If TRUE, suppresses warnings from underlying functions (default: TRUE).}

\item{return}{Logical. If TRUE, returns results; if FALSE, only displays output (default: TRUE).}
}
\value{
A list containing:
\itemize{
\item \code{x}: Processed dependent variables matrix
\item \code{g}: Grouping factor(s)
\item \code{check_multivariate_normality}: Logical indicating multivariate normality assumption
\item \code{check_covariance_homogeneity}: Logical indicating homogeneity of covariance matrices
\item \code{check_multicollinearity}: Logical indicating absence of multicollinearity
\item \code{manova_model}: Fitted MANOVA model object (NULL if robust approach)
\item \code{test_statistics}: List of test statistics (Wilks, Pillai, Hotelling-Lawley, Roy)
\item \code{k}: Updated message counter
\item \code{robust}: Logical indicating if robust methods were used
}
}
\description{
This function performs MANOVA for multiple dependent variables and one or more grouping factors.
It handles classical MANOVA, repeated measures MANOVA, MANOVA with random effects, and robust
alternatives for non-parametric situations. The function automatically checks all assumptions
(multivariate normality, homogeneity of covariance matrices, etc.) and selects the appropriate
statistical approach.
}
\details{
\strong{PIPELINE ARCHITECTURE:}
\enumerate{
\item \strong{Data validation}: Check for missing values, verify data structure
\item \strong{Assumption checks}:
\itemize{
\item Multivariate normality (Mardia, Henze-Zirkler, Royston tests)
\item Homogeneity of covariance matrices (Box's M test)
\item Independence of observations
\item Absence of multicollinearity
\item Linearity between dependent variables
\item Multivariate outliers (Mahalanobis distance)
}
\item \strong{Model selection}:
\itemize{
\item Classical MANOVA (parametric, homogeneous covariances)
\item Repeated measures MANOVA (within-subject factors)
\item MANOVA with random effects (nlme::lme or lme4::lmer)
\item Robust MANOVA (rrcov::Wilks.test with MCD estimator)
}
\item \strong{Test execution}: Wilks' Lambda, Pillai's trace, Hotelling-Lawley, Roy's largest root
\item \strong{Post-hoc analyses}: Discriminant analysis if requested
}
}
\section{Assumptions and Academic References}{


\strong{1. Multivariate Normality}

The vector of dependent variables must follow a multivariate normal distribution.

\emph{Reference:}
Mardia, K. V. (1970). Measures of multivariate skewness and kurtosis with applications.
\emph{Biometrika}, 57(3), 519-530. https://doi.org/10.1093/biomet/57.3.519

\emph{Tests used:} Mardia's test, Henze-Zirkler test, Royston's test (package: MVN)

\strong{2. Homogeneity of Covariance Matrices}

Variance-covariance matrices of dependent variables must be equal across groups (Box's M test).

\emph{Reference:}
Box, G. E. P. (1949). A general distribution theory for a class of likelihood criteria.
\emph{Biometrika}, 36(3/4), 317-346. https://doi.org/10.2307/2332671

\emph{Note:} Box's M test is very sensitive; significance is typically assessed at Î± = 0.001.

\strong{3. Independence of Observations}

Each observation must be independent of others. For repeated measures, use appropriate
repeated measures MANOVA or mixed models.

\emph{Reference:}
Field, A., Miles, J., & Field, Z. (2012). \emph{Discovering Statistics Using R}.
Sage Publications. Chapter 16.

\strong{4. Absence of Multicollinearity}

Dependent variables should not be too highly correlated (typically r < 0.90).

\emph{Reference:}
Tabachnick, B. G., & Fidell, L. S. (2019). \emph{Using Multivariate Statistics} (7th ed.).
Pearson. Chapter 7.

\strong{5. Linearity}

Linear relationships should exist between all pairs of dependent variables within each group.
Checked via scatterplot matrices and bivariate correlations.

\strong{6. Multivariate Outliers}

Detected using Mahalanobis distance. Outliers can strongly influence MANOVA results.

\emph{Reference:}
Mahalanobis, P. C. (1936). On the generalized distance in statistics.
\emph{Proceedings of the National Institute of Sciences of India}, 2(1), 49-55.

\strong{7. Sample Size}

Adequate sample size is crucial. For MANOVA, recommended minimum: n > p + g where
p = number of dependent variables, g = number of groups.

\emph{Reference:}
Stevens, J. P. (2009). \emph{Applied Multivariate Statistics for the Social Sciences} (5th ed.).
Routledge. Chapter 5.
}

\section{Non-Parametric and Robust Alternatives}{


When assumptions are violated, the function switches to robust methods:

\itemize{
\item \strong{Robust MANOVA:} Uses MCD (Minimum Covariance Determinant) estimator
(package: rrcov)
\item \strong{Permutation MANOVA:} For small samples or severe violations
\item \strong{Multivariate Kruskal-Wallis:} Non-parametric alternative (limited availability in R)
}

\emph{Reference:}
Wilcox, R. R. (2017). \emph{Introduction to Robust Estimation and Hypothesis Testing} (4th ed.).
Academic Press. https://doi.org/10.1016/C2010-0-67044-1
}

\examples{
# Example 1: Classical MANOVA with 2 groups and 3 dependent variables
set.seed(123)
data <- data.frame(
  Y1 = rnorm(60, mean = rep(c(5, 6), each = 30)),
  Y2 = rnorm(60, mean = rep(c(10, 12), each = 30)),
  Y3 = rnorm(60, mean = rep(c(15, 14), each = 30)),
  Group = factor(rep(c("A", "B"), each = 30))
)
result <- .manova_analysis(cbind(Y1, Y2, Y3) ~ Group, data = data, verbose = TRUE)

# Example 2: MANOVA with 2 factors (2x3 design)
data$FactorA <- factor(rep(c("A1", "A2"), times = 30))
data$FactorB <- factor(rep(c("B1", "B2", "B3"), each = 20))
result <- .manova_analysis(cbind(Y1, Y2, Y3) ~ FactorA * FactorB, data = data, verbose = TRUE)

}
\seealso{
\code{\link{.multi_factor_analysis}}, \code{.one_factor_analysis},
\code{\link[stats]{manova}}, \code{\link[car]{Anova}}, \code{\link[MVN]{mvn}}
}

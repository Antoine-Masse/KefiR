% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sys_posthoc.R
\name{.posthoc}
\alias{.posthoc}
\title{Réaliser différents tests post-hoc en fonction du contexte statistique}
\usage{
.posthoc(
  x,
  g,
  alpha = 0.05,
  normal = TRUE,
  number = NULL,
  var.equal = FALSE,
  control = NULL,
  verbose = TRUE,
  debug = FALSE,
  code = FALSE,
  paired = FALSE,
  boot = TRUE,
  boot_type = NULL,
  iter = 1/alpha * 10,
  conf = 0.95,
  k = NULL,
  chosen_test = NULL
)
}
\arguments{
\item{x}{Numérique. Le vecteur de données à analyser.}

\item{g}{Facteur ou vecteur catégoriel. Indique à quel groupe chaque valeur
de \code{x} est associée.}

\item{alpha}{Numérique. Seuil de signification (\emph{p-value}) pour tous
les tests (par défaut \code{0.05}).}

\item{normal}{Logique. \code{TRUE} si les données sont supposées normales,
\code{FALSE} sinon.}

\item{number}{Entier ou NULL. Nombre de groupes. Si NULL (défaut), calculé
automatiquement via \code{length(unique(g))}.}

\item{var.equal}{Logique. \code{TRUE} si la variance est supposée homogène,
\code{FALSE} sinon (par défaut \code{FALSE}).}

\item{control}{Chaîne de caractères ou vecteur ou NULL. Nom(s) du(des)
groupe(s) utilisé(s) comme contrôle(s). Si un contrôle est spécifié,
la fonction réalise également un test de Dunnett
(\code{\link[DescTools]{DunnettTest}}).}

\item{verbose}{Logique. \code{TRUE} (défaut) pour afficher des messages de
suivi, \code{FALSE} sinon.}

\item{debug}{Logique. \code{TRUE} pour afficher des messages de débogage
détaillés, \code{FALSE} (défaut) sinon.}

\item{code}{Logique. \code{TRUE} pour afficher des exemples de codes R
équivalents, \code{FALSE} (défaut) sinon.}

\item{paired}{Logique. \code{TRUE} pour des données appariées, \code{FALSE}
(défaut) sinon. Certains tests (p. ex. Wilcoxon ou \code{t.test}) tiennent
alors compte de cette information.}

\item{boot}{Logique. \code{TRUE} (défaut) pour réaliser des validations par
bootstrap, \code{FALSE} sinon.}

\item{iter}{Entier. Nombre d'itérations pour les procédures bootstrap
(par défaut \code{1/alpha * 10}).}

\item{conf}{Numérique. Niveau de confiance pour les intervalles bootstrap
(par défaut \code{0.95}).}

\item{k}{Entier ou NULL. Compteur interne pour les messages (usage avancé).}
}
\value{
\code{.posthoc} renvoie un objet de classe \code{"posthoc"}, une liste
contenant généralement :
\itemize{
\item \code{groups} : un data.frame indiquant la catégorisation de chaque
groupe selon la comparaison (lettres pour les groupes équivalents, étoiles
pour les comparaisons au contrôle, etc.) ;
\item \code{p.value} : la ou les p-values associées aux tests effectués
(valeur unique pour 2 groupes, matrice pour >2 groupes) ;
\item \code{bootstrap} : (optionnel) les résultats des comparaisons par
bootstrap, si \code{boot = TRUE}.
}
Des éléments supplémentaires peuvent être ajoutés selon le test post-hoc réalisé
(p. ex. \code{Dunnett}, \code{SNK}, \code{Wilcoxon_holm}, etc.).
}
\description{
Cette fonction \code{.posthoc} réalise un ensemble de tests post-hoc
(tests de Student, Wilcoxon, SNK, Dunn, etc.) en fonction :
\itemize{
\item du nombre de groupes à comparer (\code{number}) ;
\item de la normalité présumée des données (\code{normal}) ;
\item de l'égalité présumée des variances (\code{var.equal}) ;
\item du caractère apparié (\code{paired}) ;
\item de la présence éventuelle d'un groupe de contrôle (\code{control}).
}
}
\details{
Lorsque plusieurs groupes sont comparés, la fonction applique les procédures
post-hoc adaptées (par exemple, \code{\link[agricolae]{SNK.test}} pour SNK,
\code{\link[FSA]{dunnTest}} pour Dunn, \code{\link[DescTools]{DunnettTest}}
pour Dunnett, etc.). En cas d'options supplémentaires (\code{boot}, \code{conf},
\code{iter}), la fonction peut également réaliser des tests bootstrap via
\code{.boots()} et des analyses de paires via \code{pairwise()} (fonctionnalités
internes ou fournies par des paquets tiers).

\strong{Stratégie de sélection des tests :}
\enumerate{
\item \strong{Deux groupes seulement} (\code{number = 2}):
\itemize{
\item Si \code{normal = TRUE} : \code{t.test} (Student ou Welch selon
\code{var.equal})
\item Si \code{normal = FALSE} : \code{wilcox.test} (Wilcoxon-Mann-Whitney
ou Wilcoxon apparié)
\item Pour données appariées non normales : ajout du test de signe si
asymétrie détectée (test MGG)
}
\item \strong{Plus de deux groupes} (\code{number > 2}):
\itemize{
\item Si \code{normal = TRUE} et \code{var.equal = TRUE} :
\code{pairwise.t.test} avec pool.sd=TRUE, plus tests SNK, Tukey,
Scheffé, Waller-Duncan
\item Si \code{normal = TRUE} et \code{var.equal = FALSE} :
\code{pairwise.t.test} avec pool.sd=FALSE, plus Games-Howell et Dunnett T3
\item Si \code{normal = FALSE} : \code{pairwise.wilcox.test}, test de Dunn,
et test de Brunner-Munzel si distributions différentes détectées (test KS)
\item Pour données appariées non normales : ajout du test de Nemenyi
\item Si valeurs extrêmes détectées : ajout du test Lincon sur données
tronquées
}
}

\strong{Validation de la fiabilité des tests :}
\itemize{
\item Pour Wilcoxon non apparié : test de Kolmogorov-Smirnov (avec correction
de Sidak) pour vérifier l'identité des distributions
\item Pour Wilcoxon apparié : test MGG (Miao-Gel-Gastwirth) pour vérifier
la symétrie des différences
\item Si conditions non remplies : ajout automatique de tests alternatifs
robustes (Brunner-Munzel, test de signe)
}

Dans tous les cas, si un contrôle est spécifié (\code{control}), la fonction
effectue également un test de Dunnett (\code{\link[DescTools]{DunnettTest}})
afin de comparer ce contrôle à chacun des autres groupes.

Par ailleurs, si l'option \code{boot = TRUE}, la fonction exécute des
comparaisons par bootstrap via \code{.boots()}, et peut ainsi vérifier la
robustesse des tests classiques (en affichant des warnings si le bootstrap
détecte des incohérences).
}
\examples{
\dontrun{
# Exemple minimal (2 groupes, données normales, variances égales)
set.seed(123)
x <- rnorm(30)
g <- factor(rep(c("GroupeA", "GroupeB"), each = 15))
res <- .posthoc(x, g, alpha = 0.05, normal = TRUE, var.equal = TRUE)
print(res)

# Exemple avec plus de 2 groupes et données non normales
set.seed(123)
x2 <- runif(40)
g2 <- factor(rep(c("G1", "G2", "G3", "G4"), each = 10))
res2 <- .posthoc(x2, g2, alpha = 0.01, normal = FALSE, var.equal = FALSE)
print(res2)

# Exemple avec groupe contrôle
set.seed(456)
x3 <- c(rnorm(10, 0), rnorm(10, 1), rnorm(10, 0.5))
g3 <- factor(rep(c("Control", "TreatA", "TreatB"), each = 10))
res3 <- .posthoc(x3, g3, alpha = 0.05, normal = TRUE,
                 var.equal = TRUE, control = "Control")
print(res3)
}

}
\references{
\itemize{
\item Lehmann, E. L., & Romano, J. P. (2005). \emph{Testing Statistical
Hypotheses} (3ᵉ éd.). Springer. (test de signe, Wilcoxon)
\item Zheng, T., & Gastwirth, J. L. (2010). On bootstrap tests of symmetry
about an unknown median. \emph{Journal of Data Science}, 8(3), 397–412.
(test MGG)
\item Brunner, E., & Munzel, U. (2000). The nonparametric Behrens-Fisher
problem: Asymptotic theory and a small-sample approximation.
\emph{Biometrical Journal}, 42(1), 17-25. (test de Brunner-Munzel)
}
}
\seealso{
\itemize{
\item \code{\link{t.test}}, \code{\link{wilcox.test}} pour les tests de base,
\item \code{\link[agricolae]{SNK.test}} pour le test de Newman-Keuls,
\item \code{\link[FSA]{dunnTest}} pour le test de Dunn,
\item \code{\link[DescTools]{DunnettTest}} pour le test de Dunnett,
\item \code{\link[WRS2]{lincon}} pour les méthodes robustes (linéaires),
\item \code{\link[rstatix]{games_howell_test}} pour le test de Games-Howell,
\item \code{.boots()}, \code{pairwise()}, \code{catego()} (fonctions internes)
pour la gestion du bootstrap et des comparaisons multiples.
}
}
\keyword{internal}
